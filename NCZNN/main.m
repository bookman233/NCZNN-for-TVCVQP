
gamma = 5;
tspan = [0, 10];
tstar = 0: 0.01: 10;
options = odeset();
m = 7;

% init parameters
set = (rand(m,1)-1*ones(m,1)+i*(rand(m,1)-1*ones(m,1)))';

% set = [rand(m,1)-1*ones(m,1)+i*(rand(m,1)-1*ones(m,1))';
%        rand(m,1)-1.5*ones(m,1)+i*(rand(m,1)-1.5*ones(m,1))'];
  
set = [-0.146968882278106 - 0.876681065164835i,-0.146968882278106 - 0.816092211717583i,-0.146968882278106 - 0.760047474335097i,-0.146968882278106 - 0.582732930915631i,-0.146968882278106 - 0.950345569674258i,-0.146968882278106 - 0.0972838900847189i,-0.146968882278106 - 0.0552128102783540i;
       -0.595119031320107 - 1.23778825221915i,-0.595119031320107 - 0.897156910617917i,-0.595119031320107 - 0.788784219566317i,-0.595119031320107 - 1.27825326598276i,-0.595119031320107 - 1.38258234914419i,-0.595119031320107 - 1.20332412678167i,-0.595119031320107 - 1.18122169807412i;
       -0.649047619107729 - 0.876681065164835i,-0.649047619107729 - 0.816092211717583i,-0.649047619107729 - 0.760047474335097i,-0.649047619107729 - 0.582732930915631i,-0.649047619107729 - 0.950345569674258i,-0.649047619107729 - 0.0972838900847189i,-0.649047619107729 - 0.0552128102783540i;
       -0.486750460132947 - 0.876681065164835i,-0.486750460132947 - 0.816092211717583i,-0.486750460132947 - 0.760047474335097i,-0.486750460132947 - 0.582732930915631i,-0.486750460132947 - 0.950345569674258i,-0.486750460132947 - 0.0972838900847189i,-0.486750460132947 - 0.0552128102783540i;
       -0.598191966248058 - 0.876681065164835i,-0.598191966248058 - 0.816092211717583i,-0.598191966248058 - 0.760047474335097i,-0.598191966248058 - 0.582732930915631i,-0.598191966248058 - 0.950345569674258i,-0.598191966248058 - 0.0972838900847189i,-0.598191966248058 - 0.0552128102783540i;
       -0.924033308309158 - 0.876681065164835i,-0.924033308309158 - 0.816092211717583i,-0.924033308309158 - 0.760047474335097i,-0.924033308309158 - 0.582732930915631i,-0.924033308309158 - 0.950345569674258i,-0.924033308309158 - 0.0972838900847189i,-0.924033308309158 - 0.0552128102783540i;
       -0.760083846446342 - 0.876681065164835i,-0.760083846446342 - 0.816092211717583i,-0.760083846446342 - 0.760047474335097i,-0.760083846446342 - 0.582732930915631i,-0.760083846446342 - 0.950345569674258i,-0.760083846446342 - 0.0972838900847189i,-0.760083846446342 - 0.0552128102783540i]';

% 理论解的数据========================================================
for j = 1:length(tstar)
    TT=tstar(j);
    x11(j)=(exp(-TT*10i)*(cos(5*TT)*(3895095084737782539494 - 3813651632232395600000i) + cos(5*TT)^2*sin(5*TT)*(1744895933140715326320 + 18006715271062394240506i) - 3813651632232395600000*cos(5*TT)^2 + cos(5*TT)^3*(18006715271062394240506 - 1744895933140715326320i) - 21901810355800176780000*cos(5*TT)*sin(5*TT) + 3813651632232395600000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x12(j)= (exp(-TT*10i)*(cos(5*TT)*(6420554712225921947584 + 39012121940379514460000i) - cos(5*TT)^2*sin(5*TT)*(26570396133212188755318 - 21143247373471023732416i) + 39012121940379514460000*cos(5*TT)^2 + cos(5*TT)^3*(21143247373471023732416 + 26570396133212188755318i) - 27563802085696945680000*cos(5*TT)*sin(5*TT) - 39012121940379514460000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x13(j)=(3*exp(-TT*10i)*(cos(5*TT)*(656748373011919187362 -3523019981690754380000i) + cos(5*TT)^2*sin(5*TT)*(2166376232062299669894 + 3578958066310145952638i) - 3523019981690754380000*cos(5*TT)^2 + cos(5*TT)^3*(3578958066310145952638 - 2166376232062299669894i) - 4235706439322065140000*cos(5*TT)*sin(5*TT) + 3523019981690754380000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x14(j)=(3*exp(-TT*10i)*(cos(5*TT)*(458265418403676361306 - 5679833873860928840000i) + cos(5*TT)^2*sin(5*TT)*(3605844256050077688492 + 3104563418849048458694i) - 5679833873860928840000*cos(5*TT)^2 + cos(5*TT)^3*(3104563418849048458694 - 3605844256050077688492i) - 3562828837252724820000*cos(5*TT)*sin(5*TT) + 5679833873860928840000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x15(j)=(exp(-TT*10i)*(cos(5*TT)*(5725751245782948105384 + 14382711577304658740000i) - cos(5*TT)^2*sin(5*TT)*(10428872076468997201362 - 22701941902325376374616i) + 14382711577304658740000*cos(5*TT)^2 + cos(5*TT)^3*(22701941902325376374616 + 10428872076468997201362i) - 28427693148108324480000*cos(5*TT)*sin(5*TT) - 14382711577304658740000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x16(j)=-(exp(-TT*10i)*(cos(5*TT)*(9980198414578333896862 + 85009243140671424620000i) - cos(5*TT)^2*sin(5*TT)*(57142186896970856206806 - 28272090182876786243138i) + 85009243140671424620000*cos(5*TT)^2 + cos(5*TT)^3*(28272090182876786243138 + 57142186896970856206806i) - 38252288597455120140000*cos(5*TT)*sin(5*TT) - 85009243140671424620000))/(2*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
    x21(j)=-(exp(-TT*10i)*(10924237235706914326800000*sin(5*TT) - 522129731768917985984820000*cos(5*TT) + cos(5*TT)^2*(10924237235706914326800000 - 37674438640892164396159386i) + cos(5*TT)*sin(5*TT)*(37674438640892164396159386 + 10924237235706914326800000i) - 57955457247782441034820000i)*1i)/(20000*(23208713726056777247500*cos(5*TT)^2 - 546211861785345716340*sin(10*TT) + 2897772862389122051741));
end
% ==================================================================

for iter = 1:2
    x0 = set(iter, :);

    [t,x] = ode45(@ZnnRightHandSide,tspan,x0,options,gamma);

%     subplot(3,2,1,'FontSize',12);
    figure(1)
    plot3(real(x(:,1)),imag(x(:,1)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x11),imag(x11),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10);
    savefig('Nonconvex_5_1');
%     savefig('Ball_5_1');
    
    figure(2)
    plot3(real(x(:,2)),imag(x(:,2)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x12),imag(x12),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_2');
%     savefig('Ball_5_2');

    figure(3)
    plot3(real(x(:,3)),imag(x(:,3)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x13),imag(x13),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_3');
%     savefig('Ball_5_3');

    figure(4)
    plot3(real(x(:,4)),imag(x(:,4)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x14),imag(x14),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_4');
%     savefig('Ball_5_4');

    figure(5)
    plot3(real(x(:,5)),imag(x(:,5)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x15),imag(x15),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_5');
%     savefig('Ball_5_5');

    figure(6)
    plot3(real(x(:,6)),imag(x(:,6)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x16),imag(x16),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_6');
%     savefig('Ball_5_6');
    
    figure(7)
    plot3(real(x(:,7)),imag(x(:,7)), t, 'LineWidth', 1.5);
    xlabel('real', 'FontSize', 12);
    ylabel('imag', 'FontSize', 12);
    hold on;
    plot3(real(x21),imag(x21),tstar,'r-.','LineWidth',2);
    txt = {'{\itt} (s)'};
    text(0,-0.3,3,txt,'FontSize',10)
    savefig('Nonconvex_5_7');
%     savefig('Ball_5_7');
end